import os
from hashlib import sha1


def verify():
    assert os.path.exists('solution.txt'), 'FAIL: solution.txt does not exist'

    with open('solution.txt') as file:
        sol_lines = file.readlines()
        assert len(sol_lines) == 2, 'FAIL: solution must be exactly 2 lines long'
        lines = []
        for i in range(2):
            lines.append(sha1(sol_lines[i].strip().lower().encode('utf-8')).hexdigest())

    assert lines[0] == 'cf81d0c502933f94ba1abd872e56fb4b489d919d', 'FAIL: line 1 should be in the form XXX{ABCDE_FGHIJ}'
    assert lines[1] == '01364bd14cf0eeb1ee69d82a038b154b8ee64ccc', 'FAIL: line 2 should be a CVSS vector string starting with CVSS:'

    print("SUCCESS: challenge completed.")
    return True


verify()
